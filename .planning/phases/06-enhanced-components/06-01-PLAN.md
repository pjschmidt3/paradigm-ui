---
phase: 06-enhanced-components
plan: 01
type: execute
---

<objective>
Add loading state and pill variant to Button, plus size variants to Badge.

Purpose: Provide commonly-needed component variants that shadcn doesn't offer out of the box.
Output: Enhanced Button and Badge components with new variants, tests, and registry updates.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
./06-01-SUMMARY.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@src/components/ui/button.tsx
@src/components/ui/badge.tsx
@src/components/ui/spinner.tsx
@.planning/codebase/CONVENTIONS.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add loading state to Button</name>
  <files>src/components/ui/button.tsx, registry/new-york/ui/__tests__/button.test.tsx</files>
  <action>
    Add `loading?: boolean` prop to Button component.
    When loading=true:
    - Show Spinner component before children (import from @/src/components/ui/spinner)
    - Set aria-busy="true" on button
    - Disable the button (add disabled attribute)
    - Keep button width stable (don't collapse when text hidden)

    Add test cases for:
    - Button renders spinner when loading=true
    - Button is disabled when loading
    - Button has aria-busy when loading
  </action>
  <verify>npm test -- button.test.tsx passes, Storybook shows loading button</verify>
  <done>Button accepts loading prop, shows spinner, disables interaction when loading</done>
</task>

<task type="auto">
  <name>Task 2: Add pill variant to Button</name>
  <files>src/components/ui/button.tsx, registry/new-york/ui/__tests__/button.test.tsx</files>
  <action>
    Add `pill?: boolean` prop to Button component.
    When pill=true, apply `rounded-full` class instead of `rounded-md`.

    Implementation: Add to buttonVariants CVA:
    - New `shape` variant with values: 'default' | 'pill'
    - shape: { default: '', pill: 'rounded-full' }
    - Update component to accept shape prop, default to 'default'

    Add test case for Button with shape="pill" has rounded-full class.
  </action>
  <verify>npm test -- button.test.tsx passes, pill button is fully rounded</verify>
  <done>Button accepts shape="pill" prop for fully rounded style</done>
</task>

<task type="auto">
  <name>Task 3: Add size variants to Badge</name>
  <files>src/components/ui/badge.tsx, registry/new-york/ui/__tests__/badge.test.tsx</files>
  <action>
    Add size variants to Badge using CVA:
    - sm: 'px-1.5 py-0 text-[10px] [&>svg]:size-2.5'
    - default: 'px-2 py-0.5 text-xs [&>svg]:size-3' (current)
    - lg: 'px-2.5 py-1 text-sm [&>svg]:size-3.5'

    Update Badge props to accept `size?: 'sm' | 'default' | 'lg'`.
    Set defaultVariant for size to 'default'.
    Add data-size attribute to badge element.

    Create badge.test.tsx if not exists with tests for:
    - Badge renders with default size
    - Badge renders sm size with correct classes
    - Badge renders lg size with correct classes
  </action>
  <verify>npm test -- badge.test.tsx passes, Storybook shows size variants</verify>
  <done>Badge accepts size prop with sm, default, lg options</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm test` passes all tests
- [ ] `npm run build` succeeds without errors
- [ ] Button loading state works in Storybook
- [ ] Button pill shape works in Storybook
- [ ] Badge sizes render correctly in Storybook
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Button has loading and shape="pill" props
- Badge has size prop with 3 options
</success_criteria>

<output>
After completion, create `.planning/phases/06-enhanced-components/06-01-SUMMARY.md`
</output>
